{% from "govuk/macros/attributes.njk" import govukAttributes -%}
{% from "macros/heading/macro.njk" import heading -%}

{#
Arguments to be passed:
- layout: {string} "vertical" (default), "horizontal"
- reverse: {boolean} Reverse the layout of horizontal variant, so image shows either left or right of content.
- imageLink: {string} Absolute path of image location (e.g., assets/images/...)
- imageClass: {string} Additional CSS class to be applied if needed.
- imageAlt: {string} Alt text for image. If empty, the image will be treated as decorative for screen readers.
- imageLinkLarge: {string} Absolute path for larger image location for x2 display (e.g., assets/images/...).
#}

{%- macro _cardImage(params) %}
  {% set classNames = "app-card__image" -%}

  {% if params.imageClass %}
    {% set classNames = classNames + " " + params.imageClass %}
  {% endif -%}

  <img {{- govukAttributes({
    loading: "lazy",
    class: classNames,
    alt: params.imageAlt,
    src: params.imageLink,
    width: params.width | default("528"),
    height: params.height | default("311"),
    srcset: params.imageLinkLarge + " 2x",
    "aria-hidden": {
      value: not params.imageAlt,
      optional: true
    }
  }) -}}>
{% endmacro %}

{% if params.layout == "horizontal" %}
  <article class="app-card app-card--horizontal {% if params.reverse %} app-card--reverse{% endif %}">
    <div class="govuk-grid-column-one-half-from-desktop">
      {% if params.imageLink %}
        {{ _cardImage(params) }}
      {% endif %}
    </div>

    <div class="govuk-grid-column-one-half-from-desktop">
      {{ heading({
        text: params.title,
        size: "medium"
      }) }}

      <div class="govuk-body app-card__content">
        {{ caller() }}
      </div>
    </div>
  </article>
{% else %}
  <article class="app-card">
    {{ _cardImage(params) if params.imageLink }}

    {{ heading({
      text: params.title,
      size: "medium"
    }) }}

    <div class="govuk-body app-card__content">
      {{ caller() }}
    </div>
  </article>
{% endif %}

